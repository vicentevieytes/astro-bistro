---
import Layout from '../layouts/Layout.astro';
import Card from '../components/Card.astro';
---

<head>
	<meta charset="utf-8" />
	<!-- CSS de Leaflet -->
	<link
		rel="stylesheet"
		href="https://unpkg.com/leaflet/dist/leaflet.css"
	/>
	<!-- JS de Leaflet -->
	<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>

<Layout title="Locales Cercanos - VerLaCarta">
	<main>
		<h1>Locales Cercanos</h1>
		<!-- Aquí iría tu mapa y el contenido relacionado -->
		<div
			id="map"
			class="map-container"
			style="height: 500px;">
		</div>

		<ul
			role="list"
			class="link-card-grid">
			<Card
				href="../"
				title="Ir a la página principal"
				body="Volver a VerLaCarta"
			/>
		</ul>

		<script>
			import L from 'leaflet';
			import type { restaurante } from '../utils/CustomTypes';

			document.addEventListener('DOMContentLoaded', function () {
				// Coordenadas de Ciudad Universitaria
				const ciudadUniversitariaCoords = [-34.541895, -58.437618] as L.LatLngExpression,
					map = L.map('map').setView(ciudadUniversitariaCoords, 15);

				// Cargar el mapa base desde OpenStreetMap
				L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
					attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
				}).addTo(map);

				// Marcar la ubicación de Ciudad Universitaria
				L.marker(ciudadUniversitariaCoords).addTo(map).bindPopup('<h3>Ciudad Universitaria</h3><p>Buenos Aires</p>').openPopup();

				// Simular algunos locales cercanos con descripciones detalladas
				const localesCercanos = [
					{
						id: 1,
						name: 'Café Universitario',
						coords: [-34.5425, -58.437],
						description: 'Un lugar tranquilo para estudiar, con una excelente variedad de café y snacks.',
					},
					{
						id: 2,
						name: 'Kiosko Al Paso',
						coords: [-34.5405, -58.4385],
						description: 'Kiosko ideal para comprar cosas rápidas entre clases. Tienen de todo.',
					},
					{
						id: 3,
						name: 'Librería Universitaria',
						coords: [-34.543, -58.4368],
						description: 'Librería especializada en textos académicos y materiales de estudio.',
					},
					{
						id: 4,
						name: 'Comida Rápida Gourmet',
						coords: [-34.5427, -58.4362],
						description: 'Deliciosos platos de comida rápida, ideales para llevar entre clases.',
					},
					{
						id: 5,
						name: 'Heladería Fresca',
						coords: [-34.5434, -58.438],
						description: 'Helados artesanales para disfrutar en un día caluroso.',
					},
					{
						id: 6,
						name: 'Pizzería Universitaria',
						coords: [-34.5408, -58.4374],
						description: 'Pizzas al paso con los mejores ingredientes.',
					},
					{
						id: 7,
						name: 'Panadería El Estudiante',
						coords: [-34.542, -58.4358],
						description: 'Pan recién horneado y pasteles ideales para el desayuno.',
					},
					{
						id: 8,
						name: 'Cafetería Aroma',
						coords: [-34.5435, -58.4365],
						description: 'Cafés especiales y un ambiente acogedor para estudiar.',
					},
				] as restaurante[];

				// Agregar marcadores de locales cercanos con descripciones detalladas
				localesCercanos.forEach((local: restaurante) => {
					const marker = L.marker(local.coords).addTo(map);

					// Bind popup con descripción
					marker.bindPopup(`<a href="../local">${local.name}</a><p>${local.description}</p>`);

					// Abrir el popup al hacer clic en el marcador
					marker.on('click', () => {
						marker.openPopup();
					});

					// Console log para verificar que se añaden los marcadores
					console.log(`Marcador agregado: ${local.name} en ${local.coords}`);
				});
			});
		</script>
	</main>
</Layout>

<style>
	main {
		margin: auto;
		padding: 1rem;
		width: 800px;
		max-width: calc(100% - 2rem);
		color: white;
		font-size: 20px;
		line-height: 1.6;
	}
	.astro-a {
		position: absolute;
		top: -32px;
		left: 50%;
		transform: translatex(-50%);
		width: 220px;
		height: auto;
		z-index: -1;
	}
	h1 {
		font-size: 4rem;
		font-weight: 700;
		line-height: 1;
		text-align: center;
		margin-bottom: 1em;
	}
	.text-gradient {
		background-image: var(--accent-gradient);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-size: 400%;
		background-position: 0%;
	}
	.map-container {
		height: 500px; /* Mantener la altura que ya tenías */
		border-radius: 15px; /* Bordes redondeados */
		box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2); /* Sombra */
		overflow: hidden; /* Para que los bordes redondeados funcionen correctamente */
	}
</style>
